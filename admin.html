<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bot Control Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>body{background:#0f172a;color:#cbd5e1;font-family:monospace}</style>
</head>
<body class="p-6 max-w-xl mx-auto">
    <h1 class="text-3xl font-bold text-center mb-8 text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-purple-500">TIKTOK API MANAGER</h1>

    <div class="bg-slate-800/50 p-6 rounded-xl border border-slate-700 mb-6">
        <h2 class="text-yellow-400 font-bold mb-2">üîë PROXY XOAY KEY</h2>
        <div class="text-xs text-slate-500 mb-3">Current: <span id="cur-key" class="text-white">...</span></div>
        <div class="flex gap-2">
            <input id="inp-key" type="text" placeholder="New Proxy Key..." class="flex-1 bg-slate-900 border border-slate-600 rounded p-2 text-sm focus:border-yellow-500 outline-none">
            <button onclick="update('proxy','','inp-key')" class="bg-yellow-600 hover:bg-yellow-500 text-black font-bold px-4 rounded text-sm">SAVE</button>
        </div>
    </div>

    <div class="space-y-4">
        <div class="bg-slate-800/50 p-6 rounded-xl border border-blue-900/50">
            <div class="flex justify-between mb-2">
                <h2 class="text-blue-400 font-bold">üç™ TIKFAMES COOKIE</h2>
                <span id="st-tikfames" class="text-[10px] bg-slate-900 px-2 py-1 rounded">Checking...</span>
            </div>
            <textarea id="inp-tikfames" rows="2" placeholder="Paste cookie here..." class="w-full bg-slate-900 border border-slate-600 rounded p-2 text-xs focus:border-blue-500 outline-none mb-2"></textarea>
            <button onclick="update('cookie','tikfames','inp-tikfames')" class="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-2 rounded text-sm">UPDATE TIKFAMES</button>
        </div>

        <div class="bg-slate-800/50 p-6 rounded-xl border border-green-900/50">
            <div class="flex justify-between mb-2">
                <h2 class="text-green-400 font-bold">üç™ TIKFOLLOWERS COOKIE</h2>
                <span id="st-tikfollowers" class="text-[10px] bg-slate-900 px-2 py-1 rounded">Checking...</span>
            </div>
            <textarea id="inp-tikfollowers" rows="2" placeholder="Paste cookie here..." class="w-full bg-slate-900 border border-slate-600 rounded p-2 text-xs focus:border-green-500 outline-none mb-2"></textarea>
            <button onclick="update('cookie','tikfollowers','inp-tikfollowers')" class="w-full bg-green-600 hover:bg-green-500 text-white font-bold py-2 rounded text-sm">UPDATE TIKFOLLOWERS</button>
        </div>
    </div>

    <script>
        const API = '/api/admin';
        
        async function load() {
            try {
                const res = await fetch(API + '/config');
                const d = await res.json();
                document.getElementById('cur-key').innerText = d.proxyKey;
                setStatus('st-tikfames', d.cookies.tikfames);
                setStatus('st-tikfollowers', d.cookies.tikfollowers);
            } catch(e) { console.log("L·ªói t·∫£i config:", e); }
        }

        function setStatus(id, text) {
            const el = document.getElementById(id);
            el.innerText = text;
            el.className = text.includes('Live') 
                ? "text-[10px] bg-green-900 text-green-400 px-2 py-1 rounded font-bold"
                : "text-[10px] bg-red-900 text-red-400 px-2 py-1 rounded font-bold";
        }

        async function update(type, site, inpId) {
            const val = document.getElementById(inpId).value;
            if(!val) return alert('Empty value!');
            
            try {
                const res = await fetch(API + '/update', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ type, site, value: val })
                });
                const d = await res.json();
                if(d.success) {
                    alert(d.msg);
                    document.getElementById(inpId).value = '';
                    load();
                } else alert(d.msg);
            } catch(e) { alert("L·ªói k·∫øt n·ªëi server"); }
        }

        load();
    </script>
</body>
</html>
